Edge = SCAN(public:adhoc:edges);
Source = [addr=1];
Reachable = Source;
Delta = Source;

DO
    NewlyReachable = DISTINCT([FROM Delta, Edge
                              WHERE Delta.addr == Edge.src
                              EMIT addr=Edge.dst]);
    Delta = DIFF(NewlyReachable, Reachable);
    Reachable = UNIONALL(Delta, Reachable);
    Continue = [FROM Delta EMIT COUNT(addr)  > 0];
WHILE Continue;

DUMP (Reachable);
