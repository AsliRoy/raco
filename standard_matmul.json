{"logicalRa": "Store(public:adhoc:AB2)[Apply(i=$0,k=$1,ab=$2)[GroupBy($0,$1; COUNTALL)[Apply(follower=$0,followee1=$1)[ProjectingJoin(($1 = $2); $0,$3)[Scan(public:adhoc:TwitterM),Scan(public:adhoc:TwitterM)]]]]]", "language": "myrial", "rawQuery": "A = scan(TwitterM);\nB = A;\nAB = [from A, B\n      where A.$1 = B.$0\n      emit A.$0 as i, B.$1 as k, count(*) as ab];\nstore(AB, AB2);", "plan": {"fragments": [{"operators": [{"opName": "MyriaShuffleConsumer", "opType": "ShuffleConsumer", "opId": 0, "argOperatorId": 1}, {"opType": "MultiGroupByAggregate", "argChild": 0, "argGroupFields": [0, 1], "aggregators": [{"column": 2, "aggOps": ["SUM"], "type": "SingleColumn"}], "opName": "MyriaGroupBy($0,$1; SUM($2))", "opId": 2}, {"emitExpressions": [{"outputName": "i", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}, {"outputName": "k", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 1}}, {"outputName": "ab", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 2}}], "opName": "MyriaApply(i=$0,k=$1,ab=$2)", "opType": "Apply", "opId": 3, "argChild": 2}, {"opType": "SinkRoot", "argChild": 3, "opName": "MyriaStore(public:adhoc:AB2)", "opId": 4}]}, {"operators": [{"opName": "MyriaShuffleConsumer", "opType": "ShuffleConsumer", "opId": 5, "argOperatorId": 6}, {"opName": "MyriaShuffleConsumer", "opType": "ShuffleConsumer", "opId": 7, "argOperatorId": 8}, {"argColumnNames": ["follower", "followee"], "argChild2": "5", "argChild1": "7", "opType": "SymmetricHashJoin", "opId": 9, "opName": "MyriaSymmetricHashJoin(($1 = $2); $0,$3)", "argSelect2": [1], "argColumns1": [1], "argColumns2": [0], "argSelect1": [0]}, {"emitExpressions": [{"outputName": "follower", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 0}}, {"outputName": "followee1", "rootExpressionOperator": {"type": "VARIABLE", "columnIdx": 1}}], "opName": "MyriaApply(follower=$0,followee1=$1)", "opType": "Apply", "opId": 10, "argChild": 9}, {"opType": "MultiGroupByAggregate", "argChild": 10, "argGroupFields": [0, 1], "aggregators": [{"type": "CountAll"}], "opName": "MyriaGroupBy($0,$1; COUNTALL)", "opId": 11}, {"opName": "MyriaShuffleProducer(h($0,$1))", "opType": "ShuffleProducer", "opId": 1, "argChild": 11, "argPf": {"type": "MultiFieldHash", "indexes": [0, 1]}}]}, {"operators": [{"relationKey": {"userName": "public", "relationName": "TwitterM", "programName": "adhoc"}, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:TwitterM)", "opId": 12}, {"opName": "MyriaShuffleProducer(h($1))", "opType": "ShuffleProducer", "opId": 8, "argChild": 12, "argPf": {"index": 1, "type": "SingleFieldHash"}}]}, {"operators": [{"relationKey": {"userName": "public", "relationName": "TwitterM", "programName": "adhoc"}, "opType": "TableScan", "opName": "MyriaScan(public:adhoc:TwitterM)", "opId": 13}, {"opName": "MyriaShuffleProducer(h($0))", "opType": "ShuffleProducer", "opId": 6, "argChild": 13, "argPf": {"index": 0, "type": "SingleFieldHash"}}]}], "type": "SubQuery"}, "profilingMode": ["QUERY"]}
